# æ™ºèƒ½è§†é¢‘åˆ¶ä½œç³»ç»Ÿ

ä¸€ä¸ªåŸºäºå¤šç§AIæŠ€æœ¯çš„æ™ºèƒ½è§†é¢‘åˆ¶ä½œç³»ç»Ÿï¼Œå°†EPUBå’ŒPDFæ–‡æ¡£è‡ªåŠ¨è½¬æ¢ä¸ºçŸ­è§†é¢‘å†…å®¹ã€‚ç³»ç»Ÿé€šè¿‡LLMæ™ºèƒ½ç¼©å†™ã€å…³é”®è¯æå–ã€AIå›¾åƒç”Ÿæˆã€è¯­éŸ³åˆæˆç­‰æŠ€æœ¯ï¼Œå®ç°ä»æ–‡æ¡£åˆ°è§†é¢‘çš„å…¨è‡ªåŠ¨åŒ–åˆ¶ä½œæµç¨‹ã€‚

## ç³»ç»Ÿç‰¹ç‚¹

- ğŸ¤– **æ™ºèƒ½åŒ–å¤„ç†**: ä½¿ç”¨å¤šä¸ªå¤§è¯­è¨€æ¨¡å‹è¿›è¡Œå†…å®¹ç†è§£å’Œå‹ç¼©
- ğŸ¨ **é«˜è´¨é‡å›¾åƒ**: è±†åŒ…Seedream 3.0ç”Ÿæˆç”µå½±çº§å›¾åƒ
- ğŸ”Š **è‡ªç„¶è¯­éŸ³**: å­—èŠ‚è¯­éŸ³åˆæˆå¤§æ¨¡å‹ï¼Œæ”¯æŒå¤šéŸ³è‰²
- ğŸ¬ **è‡ªåŠ¨åˆæˆ**: å›¾åƒ+è¯­éŸ³+å­—å¹•è‡ªåŠ¨åˆæˆè§†é¢‘
- âš™ï¸  **æ¨¡å—åŒ–è®¾è®¡**: æ”¯æŒå¤šæœåŠ¡å•†åˆ‡æ¢ï¼Œé…ç½®çµæ´»
- ğŸ“Š **å®Œæ•´è¾“å‡º**: åŒ…å«è„šæœ¬ã€å…³é”®è¯ã€å¤„ç†æ‘˜è¦ç­‰å®Œæ•´ä¿¡æ¯

## ç›®å½•

- [å·¥ä½œæµç¨‹](#å·¥ä½œæµç¨‹)
- [è¾“å…¥å‚æ•°è¯´æ˜](#è¾“å…¥å‚æ•°è¯´æ˜)
- [è¾“å‡ºç»“æ„è¯´æ˜](#è¾“å‡ºç»“æ„è¯´æ˜)
- [AIæœåŠ¡å•†è¯´æ˜](#aiæœåŠ¡å•†è¯´æ˜)
- [ç¯å¢ƒé…ç½®](#ç¯å¢ƒé…ç½®)
- [ä½¿ç”¨ç¤ºä¾‹](#ä½¿ç”¨ç¤ºä¾‹)

## å·¥ä½œæµç¨‹

æœ¬ç³»ç»Ÿé‡‡ç”¨6æ­¥æ™ºèƒ½åŒ–è§†é¢‘åˆ¶ä½œæµç¨‹ï¼š

### 1. æ–‡æ¡£è¯»å–

- è‡ªåŠ¨è¯†åˆ«å¹¶è¯»å–EPUBæˆ–PDFæ–‡ä»¶ï¼ˆæ”¯æŒ10ä¸‡å­—çº§åˆ«çš„é•¿ç¯‡æ–‡æ¡£ï¼‰
- æå–æ–‡æ¡£ä¸­çš„æ–‡æœ¬å†…å®¹ï¼Œè¿‡æ»¤æ— å…³ä¿¡æ¯

### 2. æ™ºèƒ½ç¼©å†™ï¼ˆç¬¬ä¸€æ¬¡LLMå¤„ç†ï¼‰

- ä½¿ç”¨å¤§è¯­è¨€æ¨¡å‹å°†10ä¸‡å­—çº§åˆ«çš„åŸæ–‡æ™ºèƒ½å‹ç¼©ä¸º500-1000å­—çš„ç²¾ç‚¼å£æ’­ç¨¿
- è‡ªåŠ¨åˆ†æˆæŒ‡å®šæ®µæ•°ï¼Œä¿æŒå†…å®¹è¿è´¯æ€§å’Œå®Œæ•´æ€§
- è¾“å‡ºç»“æ„åŒ–JSONæ ¼å¼ï¼Œä¾¿äºåç»­å¤„ç†
- **æ–‡ä»¶ä¿å­˜**ï¼šå£æ’­ç¨¿JSONæ•°æ®ä¿å­˜åˆ° `output/{title}_{æ—¶é—´}/text/script.json`

### 3. å…³é”®è¯æå–ï¼ˆç¬¬äºŒæ¬¡LLMå¤„ç†ï¼‰

- å¯¹æ¯ä¸ªæ®µè½è¿›è¡Œæ·±åº¦åˆ†æ
- æå–æ ¸å¿ƒå…³é”®è¯å’Œè§†è§‰å…ƒç´ 
- ä¸ºå›¾åƒç”Ÿæˆåšå‡†å¤‡
- **æ–‡ä»¶ä¿å­˜**ï¼šå…³é”®è¯å’Œå›¾åƒæç¤ºè¯æ•°æ®ä¿å­˜åˆ° `output/{title}_{æ—¶é—´}/text/keywords.json`

### 4. AIå›¾åƒç”Ÿæˆ

- ç»“åˆæ®µè½å…³é”®è¯å’Œé¢„è®¾é£æ ¼æç¤ºè¯
- è°ƒç”¨è±†åŒ…Seedream 3.0æ¨¡å‹ï¼ˆ`doubao-seedream-3-0-t2i-250415`ï¼‰ç”Ÿæˆé«˜è´¨é‡å›¾åƒ
- ä½¿ç”¨ç«å±±å¼•æ“æ–¹èˆŸSDKè¿›è¡ŒAPIè°ƒç”¨
- æ¯æ®µå¯¹åº”ä¸€å¼ å›¾ç‰‡
- **æ–‡ä»¶ä¿å­˜**ï¼šç”Ÿæˆçš„å›¾ç‰‡ä¿å­˜åˆ° `output/{title}_{æ—¶é—´}/images/segment_X.png`ï¼ˆXä¸ºæ®µè½åºå·ï¼‰

### 5. è¯­éŸ³åˆæˆ

- ä½¿ç”¨å­—èŠ‚è¯­éŸ³åˆæˆå¤§æ¨¡å‹WebSocketåè®®åˆæˆè¯­éŸ³
- æ”¯æŒå¤šç§é«˜è´¨é‡ä¸­æ–‡éŸ³è‰²ï¼ˆå¦‚ï¼šzh_male_yuanboxiaoshu_moon_bigttsï¼‰
- ä¸ºæ¯ä¸ªæ®µè½ç”Ÿæˆå¯¹åº”çš„éŸ³é¢‘æ–‡ä»¶
- **æ–‡ä»¶ä¿å­˜**ï¼šè¯­éŸ³æ–‡ä»¶ä¿å­˜åˆ° `output/{title}_{æ—¶é—´}/voice/{title}_{åºå·}.wav`

### 6. è§†é¢‘åˆæˆ

- å°†å¯¹åº”çš„éŸ³é¢‘å’Œå›¾åƒè¿›è¡ŒåŒ¹é…
- ä½¿ç”¨MoviePyåˆæˆå®Œæ•´çš„çŸ­è§†é¢‘å†…å®¹
- æ”¯æŒè‡ªåŠ¨æ·»åŠ å­—å¹•åŠŸèƒ½
- **æ–‡ä»¶ä¿å­˜**ï¼šæœ€ç»ˆè§†é¢‘ä¿å­˜åˆ° `output/{title}_{æ—¶é—´}/final_video.mp4`

## è¾“å…¥å‚æ•°è¯´æ˜

ä¸»å‡½æ•° `main()`æ¥å—ä»¥ä¸‹å‚æ•°ï¼š

```python
def main(
    input_file=None,    # è¾“å…¥æ–‡ä»¶è·¯å¾„ï¼ˆEPUBæˆ–PDFæ–‡ä»¶ï¼‰ï¼Œå¦‚ä¸ºNoneåˆ™è‡ªåŠ¨ä»inputæ–‡ä»¶å¤¹è¯»å–
    target_length=800,  # ç¼©å†™åçš„ç›®æ ‡å­—æ•°ï¼ŒèŒƒå›´500-1000å­—
    num_segments=10,    # åˆ†æ®µæ•°é‡ï¼Œé»˜è®¤10æ®µ
    image_size="1280x720",  # ç”Ÿæˆå›¾ç‰‡çš„å°ºå¯¸ï¼Œæ”¯æŒå¤šç§æ¯”ä¾‹
    llm_model="google/gemini-2.5-pro",  # å¤§è¯­è¨€æ¨¡å‹
    image_model="doubao-seedream-3-0-t2i-250415",  # å›¾åƒç”Ÿæˆæ¨¡å‹
    voice="zh_male_yuanboxiaoshu_moon_bigtts",      # è¯­éŸ³éŸ³è‰²
    output_dir="output",  # è¾“å‡ºç›®å½•ï¼Œé»˜è®¤ä¸ºå½“å‰ç›®å½•ä¸‹çš„outputæ–‡ä»¶å¤¹
    image_style_preset="cinematic",  # å›¾åƒé£æ ¼é¢„è®¾ï¼Œå¯é€‰ï¼šcinematic, documentary, artisticç­‰
    enable_subtitles=True  # æ˜¯å¦å¯ç”¨å­—å¹•ï¼Œé»˜è®¤å¯ç”¨
)
```

### å‚æ•°è¯¦ç»†è¯´æ˜

**åŸºç¡€å‚æ•°**ï¼š
- `input_file`: è¾“å…¥æ–‡æ¡£è·¯å¾„ï¼Œæ”¯æŒEPUBå’ŒPDFæ ¼å¼ã€‚ä¸ºNoneæ—¶è‡ªåŠ¨ä»inputæ–‡ä»¶å¤¹è¯»å–
- `target_length`: ç›®æ ‡å­—æ•°ï¼ŒèŒƒå›´500-1000å­—
- `num_segments`: åˆ†æ®µæ•°é‡ï¼ŒèŒƒå›´5-20æ®µ
- `enable_subtitles`: æ˜¯å¦å¯ç”¨å­—å¹•åŠŸèƒ½

**AIæ¨¡å‹å‚æ•°**ï¼ˆç³»ç»Ÿä¼šè‡ªåŠ¨æ£€æµ‹æœåŠ¡å•†ï¼‰ï¼š
- `llm_model`: å¤§è¯­è¨€æ¨¡å‹é€‰æ‹©
  - OpenRouteræœåŠ¡å•†: `google/gemini-2.5-pro`, `anthropic/claude-sonnet-4`
  - SiliconFlowæœåŠ¡å•†: `zai-org/GLM-4.5`, `moonshotai/Kimi-K2-Instruct`
  - OpenAIä»£ç†: `gpt-5`
- `image_model`: å›¾åƒç”Ÿæˆæ¨¡å‹ï¼Œå½“å‰æ”¯æŒ `doubao-seedream-3-0-t2i-250415`
- `voice`: è¯­éŸ³éŸ³è‰²ï¼Œå¦‚ `zh_male_yuanboxiaoshu_moon_bigtts`, `zh_female_linjianvhai_moon_bigtts`

**è§†è§‰å‚æ•°**ï¼š
- `image_size`: å›¾åƒå°ºå¯¸ï¼Œæ”¯æŒå¤šç§æ¯”ä¾‹ï¼ˆ1024x1024, 1280x720, 720x1280ç­‰ï¼‰
- `image_style_preset`: é¢„è®¾é£æ ¼ï¼ˆcinematic, documentary, artistic, minimalist, vintageï¼‰

## è¾“å‡ºç»“æ„è¯´æ˜

### 1. æ–‡ä»¶å¤¹ç»“æ„

```
output/
â””â”€â”€ {title}_{æœˆæ—¥_æ—¶åˆ†}/     # æŒ‰æ–‡æ¡£æ ‡é¢˜å’Œæ—¶é—´å‘½åçš„é¡¹ç›®æ–‡ä»¶å¤¹
    â”œâ”€â”€ images/              # ç”Ÿæˆçš„å›¾ç‰‡æ–‡ä»¶å¤¹
    â”‚   â”œâ”€â”€ segment_1.png   # ç¬¬1æ®µå¯¹åº”å›¾ç‰‡
    â”‚   â”œâ”€â”€ segment_2.png   # ç¬¬2æ®µå¯¹åº”å›¾ç‰‡
    â”‚   â””â”€â”€ ...             # å…±10å¼ å›¾ç‰‡
    â”œâ”€â”€ voice/              # ç”Ÿæˆçš„è¯­éŸ³æ–‡ä»¶å¤¹
    â”‚   â”œâ”€â”€ {title}_1.wav   # ç¬¬1æ®µå£æ’­éŸ³é¢‘ï¼ˆä»¥æ ‡é¢˜å‘½åï¼‰
    â”‚   â”œâ”€â”€ {title}_2.wav   # ç¬¬2æ®µå£æ’­éŸ³é¢‘
    â”‚   â””â”€â”€ ...             # å…±10ä¸ªéŸ³é¢‘æ–‡ä»¶
    â”œâ”€â”€ text/               # ç”Ÿæˆçš„æ–‡æœ¬ä¿¡æ¯æ–‡ä»¶å¤¹
    â”‚   â”œâ”€â”€ script.json     # ç¼©å†™åçš„å£æ’­ç¨¿JSONæ–‡ä»¶
    â”‚   â””â”€â”€ keywords.json   # å…³é”®è¯æå–ç»“æœJSONæ–‡ä»¶
    â””â”€â”€ final_video.mp4     # æœ€ç»ˆåˆæˆçš„è§†é¢‘æ–‡ä»¶
```

**æ–‡ä»¶å¤¹å‘½åè§„åˆ™ï¼š**

- æ¯æ¬¡è¿è¡Œéƒ½ä¼šåœ¨ `output` ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªæ–°çš„é¡¹ç›®æ–‡ä»¶å¤¹
- æ–‡ä»¶å¤¹åæ ¼å¼ï¼š`{title}_{æœˆæ—¥_æ—¶åˆ†}`
- `title` æ¥è‡ªLLMç¬¬ä¸€æ¬¡å¤„ç†æ—¶ç”Ÿæˆçš„æ–‡æ¡£æ ‡é¢˜
- æ—¶é—´æ ¼å¼ä¸ºï¼šæœˆæ—¥_æ—¶åˆ†ï¼ˆå¦‚ï¼š0820_1430 è¡¨ç¤º 8æœˆ20æ—¥14:30ï¼‰
- ç‰¹æ®Šå­—ç¬¦ä¼šè¢«æ›¿æ¢ä¸ºä¸‹åˆ’çº¿ï¼ˆç©ºæ ¼ã€æ–œæ ç­‰ï¼‰

**ç¤ºä¾‹ï¼š**

- æ–‡æ¡£æ ‡é¢˜ï¼š"ä¸‰ä½“ç§‘å¹»å°è¯´" â†’ æ–‡ä»¶å¤¹åï¼š"ä¸‰ä½“ç§‘å¹»å°è¯´_0820_1430"
- æ–‡æ¡£æ ‡é¢˜ï¼š"My Novel/Part 1" â†’ æ–‡ä»¶å¤¹åï¼š"My_Novel_Part_1_0820_1430"

### 2. å£æ’­ç¨¿JSONç»“æ„ï¼ˆtext/script.jsonï¼‰

**LLMè¾“å‡ºæ ¼å¼ï¼ˆæ ¸å¿ƒå†…å®¹ï¼‰ï¼š**

```json
{
    "title": "æ–‡æ¡£æ ‡é¢˜",
    "segments": [
        {
            "content": "è¿™æ˜¯ç¬¬ä¸€æ®µå£æ’­å†…å®¹ï¼Œå¤§çº¦80å­—å·¦å³ï¼Œéœ€è¦ä¿æŒè¯­è¨€æµç•…è‡ªç„¶ï¼Œé€‚åˆè¯­éŸ³æ’­æŠ¥ã€‚"
        },
        {
            "content": "è¿™æ˜¯ç¬¬äºŒæ®µå£æ’­å†…å®¹ï¼Œç»§ç»­è®²è¿°æ•…äº‹çš„ä¸»è¦æƒ…èŠ‚å’Œå…³é”®ä¿¡æ¯ã€‚"
        },
        {
            "content": "è¿™æ˜¯ç¬¬ä¸‰æ®µå£æ’­å†…å®¹..."
        }
    ]
}
```

**æœ€ç»ˆä¿å­˜æ ¼å¼ï¼ˆç³»ç»Ÿå¤„ç†åï¼‰ï¼š**

```json
{
    "title": "æ–‡æ¡£æ ‡é¢˜",
    "total_length": 800,
    "target_segments": 10,
    "actual_segments": 10,
    "created_time": "2024-01-15T10:30:00Z",
    "model_info": {
        "llm_server": "openrouter",
        "llm_model": "google/gemini-2.5-pro",
        "generation_type": "script_generation"
    },
    "segments": [
        {
            "index": 1,
            "content": "è¿™æ˜¯ç¬¬ä¸€æ®µå£æ’­å†…å®¹ï¼Œå¤§çº¦80å­—å·¦å³ï¼Œéœ€è¦ä¿æŒè¯­è¨€æµç•…è‡ªç„¶ï¼Œé€‚åˆè¯­éŸ³æ’­æŠ¥ã€‚",
            "length": 42,
            "estimated_duration": 8.4
        },
        {
            "index": 2,
            "content": "è¿™æ˜¯ç¬¬äºŒæ®µå£æ’­å†…å®¹ï¼Œç»§ç»­è®²è¿°æ•…äº‹çš„ä¸»è¦æƒ…èŠ‚å’Œå…³é”®ä¿¡æ¯ã€‚",
            "length": 38,
            "estimated_duration": 7.6
        }
    ]
}
```

**å­—æ®µè¯´æ˜ï¼š**

**LLMè¾“å‡ºå­—æ®µ**ï¼ˆå¿…é¡»ï¼‰ï¼š

- `title`: å­—ç¬¦ä¸²ï¼Œä»åŸæ–‡æ¡£æå–æˆ–ç”Ÿæˆçš„æ ‡é¢˜
- `segments`: æ•°ç»„ï¼ŒåŒ…å«æ‰€æœ‰æ®µè½çš„å£æ’­å†…å®¹
  - `content`: å­—ç¬¦ä¸²ï¼Œè¯¥æ®µçš„å£æ’­æ–‡æœ¬å†…å®¹

**ç³»ç»Ÿè¡¥å……å­—æ®µ**ï¼ˆç¨‹åºè‡ªåŠ¨æ·»åŠ ï¼‰ï¼š

- `total_length`: æ•´æ•°ï¼Œæ‰€æœ‰æ®µè½å†…å®¹çš„æ€»å­—æ•°
- `target_segments`: æ•´æ•°ï¼Œç”¨æˆ·æŒ‡å®šçš„ç›®æ ‡åˆ†æ®µæ•°
- `actual_segments`: æ•´æ•°ï¼Œå®é™…ç”Ÿæˆçš„æ®µè½æ•°
- `created_time`: å­—ç¬¦ä¸²ï¼ŒISO 8601æ ¼å¼çš„åˆ›å»ºæ—¶é—´
- `model_info`: å¯¹è±¡ï¼Œä½¿ç”¨çš„æ¨¡å‹ä¿¡æ¯
  - `llm_server`: å­—ç¬¦ä¸²ï¼ŒLLMæœåŠ¡å•†ï¼ˆopenrouter/siliconflow/openaiï¼‰
  - `llm_model`: å­—ç¬¦ä¸²ï¼Œå…·ä½“çš„LLMæ¨¡å‹åç§°
  - `generation_type`: å­—ç¬¦ä¸²ï¼Œç”Ÿæˆç±»å‹ï¼ˆscript_generationï¼‰
- `segments[].index`: æ•´æ•°ï¼Œæ®µè½åºå·ï¼ˆä»1å¼€å§‹ï¼‰
- `segments[].length`: æ•´æ•°ï¼Œè¯¥æ®µçš„å­—ç¬¦æ•°
- `segments[].estimated_duration`: æµ®ç‚¹æ•°ï¼Œé¢„ä¼°æ’­æ”¾æ—¶é•¿ï¼ˆç§’ï¼‰

**æ’­æ”¾æ—¶é•¿è®¡ç®—è§„åˆ™ï¼š**

- è¯­é€Ÿæ ‡å‡†ï¼šä¸€åˆ†é’Ÿ300å­—ï¼ˆä¸­æ–‡æ™®é€šè¯æ­£å¸¸è¯­é€Ÿï¼‰
- è®¡ç®—å…¬å¼ï¼š`estimated_duration = length / 300 * 60`
- ç¤ºä¾‹ï¼š42å­—çš„å†…å®¹ = 42 Ã· 300 Ã— 60 = 8.4ç§’

### 3. å…³é”®è¯JSONç»“æ„ï¼ˆtext/keywords.jsonï¼‰

**LLMè¾“å‡ºæ ¼å¼ï¼ˆæ ¸å¿ƒå†…å®¹ï¼‰ï¼š**

```json
{
    "segments": [
        {
            "keywords": ["å¤ä»£å»ºç­‘", "çº¢å¢™é»„ç“¦", "åº­é™¢æ·±æ·±"],
            "atmosphere": ["åº„ä¸¥è‚ƒç©†", "å¤éŸµæ‚ é•¿", "é‡‘è¾‰æ´’åœ°"]
        },
        {
            "keywords": ["æ±Ÿå—æ°´ä¹¡", "å°æ¡¥æµæ°´", "é’çŸ³æ¿è·¯"],
            "atmosphere": ["çƒŸé›¨æœ¦èƒ§", "å®é™è‡´è¿œ", "è¯—æ„ç›ç„¶"]
        },
        {
            "keywords": ["ç°ä»£éƒ½å¸‚", "éœ“è™¹é—ªçƒ", "é«˜æ¥¼å¤§å¦"],
            "atmosphere": ["ç¹åå–§åš£", "å…‰å½±äº¤é”™", "ç°ä»£æ„Ÿ"]
        }
    ]
}
```

**ä¿å­˜æ ¼å¼ï¼ˆç³»ç»Ÿå¤„ç†åï¼‰ï¼š**

```json
{
    "model_info": {
        "llm_server": "openrouter",
        "llm_model": "google/gemini-2.5-pro",
        "generation_type": "keywords_extraction"
    },
    "created_time": "2024-01-15T10:35:00Z",
    "segments": [
        {
            "keywords": ["å¤ä»£å»ºç­‘", "çº¢å¢™é»„ç“¦", "åº­é™¢æ·±æ·±"],
            "atmosphere": ["åº„ä¸¥è‚ƒç©†", "å¤éŸµæ‚ é•¿", "é‡‘è¾‰æ´’åœ°"]
        },
        {
            "keywords": ["æ±Ÿå—æ°´ä¹¡", "å°æ¡¥æµæ°´", "é’çŸ³æ¿è·¯"],
            "atmosphere": ["çƒŸé›¨æœ¦èƒ§", "å®é™è‡´è¿œ", "è¯—æ„ç›ç„¶"]
        },
        {
            "keywords": ["ç°ä»£éƒ½å¸‚", "éœ“è™¹é—ªçƒ", "é«˜æ¥¼å¤§å¦"],
            "atmosphere": ["ç¹åå–§åš£", "å…‰å½±äº¤é”™", "ç°ä»£æ„Ÿ"]
        }
    ]
}
```

**å­—æ®µè¯´æ˜ï¼š**

- `model_info`: å¯¹è±¡ï¼Œä½¿ç”¨çš„æ¨¡å‹ä¿¡æ¯
  - `llm_server`: å­—ç¬¦ä¸²ï¼ŒLLMæœåŠ¡å•†
  - `llm_model`: å­—ç¬¦ä¸²ï¼Œå…·ä½“çš„LLMæ¨¡å‹åç§°
  - `generation_type`: å­—ç¬¦ä¸²ï¼Œç”Ÿæˆç±»å‹ï¼ˆkeywords_extractionï¼‰
- `created_time`: å­—ç¬¦ä¸²ï¼Œæ–‡ä»¶åˆ›å»ºæ—¶é—´
- `segments`: æ•°ç»„ï¼Œæ¯æ®µçš„å…³é”®è¯ä¿¡æ¯
  - `keywords`: å­—ç¬¦ä¸²æ•°ç»„ï¼Œç”»é¢å†…å®¹å…³é”®è¯ï¼ˆç‰©ä½“ã€åœºæ™¯ã€äººç‰©ç­‰å…·è±¡å…ƒç´ ï¼‰
  - `atmosphere`: å­—ç¬¦ä¸²æ•°ç»„ï¼Œæ°›å›´æ„Ÿå…³é”®è¯ï¼ˆæƒ…æ„Ÿã€æ°›å›´ã€æ„Ÿè§‰ç­‰æŠ½è±¡å…ƒç´ ï¼‰

**å›¾ç‰‡ç”Ÿæˆæµç¨‹ï¼š**

1. LLMæå–å…³é”®è¯ â†’ ç›´æ¥ä¿å­˜åˆ°keywords.json
2. ç”Ÿæˆå›¾ç‰‡æ—¶ï¼šç»“åˆé¢„è®¾æ¨¡æ¿ + ç”¨æˆ·é£æ ¼è®¾ç½® + å…³é”®è¯ â†’ è°ƒç”¨Seedream 3.0
3. æ¨¡æ¿è¯ç»„åˆè§„åˆ™ï¼š`[é¢„è®¾æ¨¡æ¿] + [ç”¨æˆ·é£æ ¼] + [keywords] + [atmosphere] + [è´¨é‡åç¼€]`

**å…³é”®è¯åˆ†ç±»è¯´æ˜ï¼š**

- **keywords**ï¼šç”»é¢ä¸­å¯è§çš„å…·ä½“å†…å®¹ï¼ˆå¦‚ï¼šå¤ä»£å»ºç­‘ã€çº¢å¢™é»„ç“¦ã€äººç‰©ã€åŠ¨ä½œç­‰ï¼‰
- **atmosphere**ï¼šç”»é¢çš„æƒ…æ„Ÿå’Œæ°›å›´è¡¨è¾¾ï¼ˆå¦‚ï¼šåº„ä¸¥è‚ƒç©†ã€æ¸©é¦¨æµªæ¼«ã€ç´§å¼ åˆºæ¿€ç­‰ï¼‰

### 4. ç¨‹åºè¿”å›å€¼ç»“æ„

```python
{
    "success": True,
    "message": "è§†é¢‘åˆ¶ä½œå®Œæˆ",
    "execution_time": 245.6,
    "script": {
        "file_path": "output/text/script.json",
        "total_length": 800,
        "segments_count": 10
    },
    "keywords": {
        "file_path": "output/text/keywords.json",
        "total_keywords": 28,
        "avg_per_segment": 2.8
    },
    "images": [
        "output/images/segment_1.png",
        "output/images/segment_2.png",
        "... (å…±10ä¸ªæ–‡ä»¶)"
    ],
    "audio_files": [
        "output/voice/segment_1.wav",
        "output/voice/segment_2.wav",
        "... (å…±10ä¸ªæ–‡ä»¶)"
    ],
    "final_video": "output/final_video.mp4",
    "statistics": {
        "original_length": 102345,
        "compression_ratio": "99.2%",
        "total_processing_time": 245.6,
        "llm_calls": 2,
        "image_generation_time": 120.3,
        "audio_generation_time": 45.2,
        "video_composition_time": 15.8
    }
}
```

**å­—æ®µè¯´æ˜ï¼š**

- `success`: å¸ƒå°”å€¼ï¼Œå¤„ç†æ˜¯å¦æˆåŠŸ
- `message`: å­—ç¬¦ä¸²ï¼Œå¤„ç†ç»“æœæ¶ˆæ¯
- `execution_time`: æµ®ç‚¹æ•°ï¼Œæ€»æ‰§è¡Œæ—¶é—´ï¼ˆç§’ï¼‰
- `script`: å¯¹è±¡ï¼Œå£æ’­ç¨¿ç›¸å…³ä¿¡æ¯
- `keywords`: å¯¹è±¡ï¼Œå…³é”®è¯ç›¸å…³ä¿¡æ¯
- `images`: å­—ç¬¦ä¸²æ•°ç»„ï¼Œç”Ÿæˆå›¾ç‰‡çš„å®Œæ•´è·¯å¾„åˆ—è¡¨
- `audio_files`: å­—ç¬¦ä¸²æ•°ç»„ï¼ŒéŸ³é¢‘æ–‡ä»¶çš„å®Œæ•´è·¯å¾„åˆ—è¡¨
- `final_video`: å­—ç¬¦ä¸²ï¼Œæœ€ç»ˆè§†é¢‘æ–‡ä»¶çš„å®Œæ•´è·¯å¾„
- `statistics`: å¯¹è±¡ï¼Œè¯¦ç»†çš„å¤„ç†ç»Ÿè®¡ä¿¡æ¯

## AIæœåŠ¡å•†æ”¯æŒ

ç³»ç»Ÿé‡‡ç”¨**è‡ªåŠ¨æœåŠ¡å•†æ£€æµ‹**æœºåˆ¶ï¼Œæ ¹æ®æ¨¡å‹åç§°è‡ªåŠ¨é€‰æ‹©å¯¹åº”çš„æœåŠ¡å•†ï¼Œæ— éœ€æ‰‹åŠ¨æŒ‡å®šã€‚

### å¤§è¯­è¨€æ¨¡å‹ (LLM)

**OpenRouter æœåŠ¡å•†**ï¼ˆæ¨èï¼‰
- é€šè¿‡OpenRouterç»Ÿä¸€è°ƒç”¨å¤šä¸ªé¡¶çº§æ¨¡å‹
- æ”¯æŒæ¨¡å‹ï¼š
  - `google/gemini-2.5-pro` - æœ€æ–°Geminiæ¨¡å‹ï¼Œæ”¯æŒå¤§å®¹é‡æ–‡æ¡£å¤„ç†
  - `anthropic/claude-sonnet-4` - Claudeæœ€æ–°ç‰ˆæœ¬ï¼Œæ“…é•¿æ–‡å­¦ä½œå“ç†è§£
  - `anthropic/claude-3.7-sonnet:thinking` - æ”¯æŒæ€ç»´é“¾æ¨ç†çš„Claudeæ¨¡å‹

**SiliconFlow æœåŠ¡å•†**
- å…¼å®¹OpenAI SDKæ¥å£ï¼Œå›½å†…è®¿é—®ç¨³å®š
- æ¨èæ¨¡å‹ï¼š
  - `zai-org/GLM-4.5` - æ™ºè°±AIæœ€æ–°ç‰ˆæœ¬
  - `moonshotai/Kimi-K2-Instruct` - æœˆä¹‹æš—é¢Kimiæ¨¡å‹
  - `Qwen/Qwen3-235B-A22B-Thinking-2507` - é˜¿é‡Œé€šä¹‰åƒé—®æ€ç»´é“¾æ¨¡å‹

**OpenAI ä»£ç†æœåŠ¡å•†**ï¼ˆaihubmixï¼‰
- æ”¯æŒæ¨¡å‹ï¼š`gpt-5`
- é€šè¿‡ä»£ç†è®¿é—®OpenAI API

### å›¾åƒç”Ÿæˆ

**è±†åŒ… Seedream 3.0**
- æ¨¡å‹ï¼š`doubao-seedream-3-0-t2i-250415`
- å­—èŠ‚è·³åŠ¨æ——ä¸‹å›¾åƒç”Ÿæˆæ¨¡å‹ï¼Œæ”¯æŒä¸­æ–‡æç¤ºè¯ä¼˜åŒ–
- åŸºäºç«å±±å¼•æ“æ–¹èˆŸSDKè°ƒç”¨ï¼Œç”Ÿæˆè´¨é‡é«˜ä¸”å“åº”é€Ÿåº¦å¿«
- æ”¯æŒå‚æ•°ï¼šå›¾åƒå°ºå¯¸ã€å¼•å¯¼å¼ºåº¦ã€éšæœºç§å­ã€æ°´å°æ§åˆ¶

### è¯­éŸ³åˆæˆ

**å­—èŠ‚è¯­éŸ³åˆæˆå¤§æ¨¡å‹**
- ä½¿ç”¨WebSocketåè®®è¿›è¡Œå®æ—¶è¯­éŸ³åˆæˆ
- æ”¯æŒå¤šç§é«˜è´¨é‡ä¸­æ–‡éŸ³è‰²ï¼š
  - `zh_male_yuanboxiaoshu_moon_bigtts` - ç”·å£°ï¼ˆå…ƒä¼¯å°å”é£æ ¼ï¼‰
  - `zh_female_linjianvhai_moon_bigtts` - å¥³å£°ï¼ˆæ—å»ºæµ·é£æ ¼ï¼‰
  - `zh_male_yangguangqingnian_moon_bigtts` - ç”·å£°ï¼ˆé˜³å…‰é’å¹´é£æ ¼ï¼‰
- ä¸“ä¸ºä¸­æ–‡å†…å®¹ä¼˜åŒ–ï¼Œå‘éŸ³è‡ªç„¶æµç•…

## ç¯å¢ƒé…ç½®

### APIå¯†é’¥é…ç½®

åœ¨ `.env`æ–‡ä»¶ä¸­é…ç½®ä»¥ä¸‹ç¯å¢ƒå˜é‡ï¼š

```env
# LLMæœåŠ¡å•†APIå¯†é’¥
OPENROUTER_API_KEY=ä½ çš„OpenRouter APIå¯†é’¥
SILICONFLOW_KEY=ä½ çš„SiliconFlow APIå¯†é’¥
AIHUBMIX_API_KEY=ä½ çš„aihubmixä»£ç†APIå¯†é’¥

# å›¾åƒç”ŸæˆæœåŠ¡ï¼ˆè±†åŒ…Seedream 3.0ï¼‰
SEEDREAM_API_KEY=ä½ çš„ç«å±±å¼•æ“æ–¹èˆŸAPIå¯†é’¥

# è¯­éŸ³åˆæˆæœåŠ¡ï¼ˆå­—èŠ‚è¯­éŸ³åˆæˆå¤§æ¨¡å‹ï¼‰
BYTEDANCE_TTS_APPID=ä½ çš„å­—èŠ‚è¯­éŸ³APPID
BYTEDANCE_TTS_ACCESS_TOKEN=ä½ çš„å­—èŠ‚è¯­éŸ³ACCESS_TOKEN
BYTEDANCE_TTS_SECRET_KEY=ä½ çš„å­—èŠ‚è¯­éŸ³SECRET_KEYï¼ˆå¯é€‰ï¼‰
```

### å¿…éœ€çš„APIå¯†é’¥

æ ¹æ®ä½ é€‰æ‹©çš„æ¨¡å‹ï¼Œéœ€è¦é…ç½®å¯¹åº”çš„APIå¯†é’¥ï¼š

**LLMæ¨¡å‹**ï¼š
- OpenRouteræ¨¡å‹ï¼šéœ€è¦ `OPENROUTER_API_KEY`
- SiliconFlowæ¨¡å‹ï¼šéœ€è¦ `SILICONFLOW_KEY`
- OpenAIä»£ç†æ¨¡å‹ï¼šéœ€è¦ `AIHUBMIX_API_KEY`

**å›¾åƒç”Ÿæˆ**ï¼š
- è±†åŒ…Seedream 3.0ï¼šéœ€è¦ `SEEDREAM_API_KEY`

**è¯­éŸ³åˆæˆ**ï¼š
- å­—èŠ‚è¯­éŸ³åˆæˆï¼šéœ€è¦ `BYTEDANCE_TTS_APPID` å’Œ `BYTEDANCE_TTS_ACCESS_TOKEN`

### ä¾èµ–åŒ…å®‰è£…

```bash
# å®‰è£…æ‰€æœ‰ä¾èµ–åŒ…
pip install -r requirements.txt

# æˆ–è€…æ‰‹åŠ¨å®‰è£…
pip install openai>=1.12.0 requests>=2.31.0 python-dotenv>=1.0.0 Pillow>=10.0.0 \
            moviepy>=2.0.0 ebooklib>=0.18 PyPDF2>=3.0.1 pdfplumber>=0.9.0 \
            websockets>=11.0.0 "volcengine-python-sdk[ark]">=1.0.94
```

### ç³»ç»Ÿè¦æ±‚

- Python 3.8+
- æ“ä½œç³»ç»Ÿï¼šmacOS, Linux, Windows
- å†…å­˜ï¼šå»ºè®®8GBä»¥ä¸Šï¼ˆå¤„ç†å¤§å‹æ–‡æ¡£æ—¶ï¼‰
- ç¡¬ç›˜ï¼šè‡³å°‘2GBå¯ç”¨ç©ºé—´ï¼ˆå­˜å‚¨ç”Ÿæˆçš„è§†é¢‘æ–‡ä»¶ï¼‰

## ä½¿ç”¨ç¤ºä¾‹

### åŸºç¡€ç”¨æ³•

**æ­¥éª¤1ï¼šå‡†å¤‡è¾“å…¥æ–‡ä»¶**

```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»ºinputæ–‡ä»¶å¤¹
mkdir input
# å°†EPUBæˆ–PDFæ–‡ä»¶æ”¾å…¥inputæ–‡ä»¶å¤¹
cp your_book.epub input/
# æˆ–
cp your_book.pdf input/
```

**æ­¥éª¤2ï¼šè¿è¡Œç¨‹åº**

```python
from main import main

# è‡ªåŠ¨è¯»å–inputæ–‡ä»¶å¤¹ä¸­çš„æ–‡ä»¶ï¼Œç”Ÿæˆ800å­—10æ®µè§†é¢‘
result = main(
    target_length=800,
    num_segments=10,
    image_size="1280x720",
    llm_model="google/gemini-2.5-pro",
    image_model="doubao-seedream-3-0-t2i-250415",
    voice="zh_male_yuanboxiaoshu_moon_bigtts",
    image_style_preset="cinematic",
    enable_subtitles=True
)

if result["success"]:
    print("è§†é¢‘åˆ¶ä½œå®Œæˆï¼")
    print(f"å£æ’­ç¨¿æ®µæ•°: {result['script']['segments_count']}")
    print(f"ç”Ÿæˆå›¾ç‰‡æ•°é‡: {len(result['images'])}")
    print(f"éŸ³é¢‘æ–‡ä»¶æ•°é‡: {len(result['audio_files'])}")
    print(f"æœ€ç»ˆè§†é¢‘: {result['final_video']}")
    print(f"å¤„ç†æ—¶é—´: {result['execution_time']:.1f}ç§’")
else:
    print(f"å¤„ç†å¤±è´¥: {result['message']}")
```

### é«˜çº§é…ç½®ç¤ºä¾‹

```python
# æŒ‡å®šå…·ä½“æ–‡ä»¶è·¯å¾„å’Œè‡ªå®šä¹‰å‚æ•°
result = main(
    input_file="input/my_novel.epub",
    target_length=900,  # ç”Ÿæˆ900å­—å£æ’­ç¨¿
    num_segments=12,    # åˆ†æˆ12æ®µ
    image_size="1024x1024",
    llm_model="anthropic/claude-sonnet-4",
    image_model="doubao-seedream-3-0-t2i-250415",
    voice="zh_female_linjianvhai_moon_bigtts",
    image_style_preset="artistic",
    enable_subtitles=True,
    output_dir="custom_output"
)

# ä½¿ç”¨æ€ç»´é“¾æ¨¡å‹è¿›è¡Œæ›´ç²¾ç¡®çš„å†…å®¹å¤„ç†
result = main(
    input_file="input/complex_story.pdf",
    target_length=500,  # ç”Ÿæˆ500å­—çŸ­è§†é¢‘
    num_segments=8,     # åˆ†æˆ8æ®µ
    image_size="720x1280",  # ç«–å±æ ¼å¼ï¼Œé€‚åˆçŸ­è§†é¢‘å¹³å°
    llm_model="anthropic/claude-3.7-sonnet:thinking",
    image_model="doubao-seedream-3-0-t2i-250415",
    voice="zh_male_yangguangqingnian_moon_bigtts",
    image_style_preset="documentary",
    enable_subtitles=False  # ç¦ç”¨å­—å¹•
)

# ä½¿ç”¨SiliconFlowçš„å›½äº§æ¨¡å‹
result = main(
    input_file="input/history_book.pdf",
    target_length=800,
    num_segments=10,
    image_size="1280x720",
    llm_model="zai-org/GLM-4.5",  # æ™ºè°±AIæ¨¡å‹
    image_model="doubao-seedream-3-0-t2i-250415",
    voice="zh_male_yuanboxiaoshu_moon_bigtts",
    image_style_preset="vintage",  # å¤å¤é£æ ¼
    enable_subtitles=True
)
```

## æ”¯æŒçš„æ¨¡å‹å’Œå‚æ•°

### å›¾åƒå°ºå¯¸é€‰é¡¹
```
"1024x1024"    # 1:1 æ–¹å½¢ï¼Œé€‚åˆç¤¾äº¤åª’ä½“
"1280x720"     # 16:9 æ¨ªå±ï¼Œé€‚åˆYouTubeç­‰è§†é¢‘å¹³å°
"720x1280"     # 9:16 ç«–å±ï¼Œé€‚åˆæŠ–éŸ³ã€å¿«æ‰‹ç­‰çŸ­è§†é¢‘
"864x1152"     # 3:4 ç«–å±ï¼Œé€‚åˆæ‰‹æœºè§‚çœ‹
"1152x864"     # 4:3 æ¨ªå±ï¼Œé€‚åˆä¼ ç»Ÿå±å¹•
"832x1248"     # 2:3 ç«–å±ï¼Œé€‚åˆæµ·æŠ¥é£æ ¼
"1248x832"     # 3:2 æ¨ªå±ï¼Œé€‚åˆæ‘„å½±ä½œå“
"1512x648"     # 21:9 è¶…å®½å±ï¼Œé€‚åˆç”µå½±é£æ ¼
```

### å›¾åƒé£æ ¼é¢„è®¾
```
"cinematic"    # ç”µå½±çº§è´¨æ„Ÿï¼Œæ¸©æš–è‰²è°ƒï¼Œç»†è…»ç”»é£
"documentary"  # çºªå½•ç‰‡é£æ ¼ï¼Œè‡ªç„¶çœŸå®ï¼Œé«˜æ¸…æ‘„å½±
"artistic"     # è‰ºæœ¯æ’ç”»é£æ ¼ï¼Œè‰²å½©ä¸°å¯Œï¼Œåˆ›æ„è¡¨ç°
"minimalist"   # ç®€çº¦ç°ä»£é£æ ¼ï¼Œå¹²å‡€æ„å›¾ï¼Œç®€æ´é…è‰²
"vintage"      # å¤å¤æ€€æ—§é£æ ¼ï¼Œèƒ¶ç‰‡è´¨æ„Ÿï¼Œæš–è‰²è°ƒ
```

### è¯­éŸ³éŸ³è‰²é€‰é¡¹
```
"zh_male_yuanboxiaoshu_moon_bigtts"      # ç”·å£°ï¼ˆå…ƒä¼¯å°å”é£æ ¼ï¼‰
"zh_female_linjianvhai_moon_bigtts"      # å¥³å£°ï¼ˆæ—å»ºæµ·é£æ ¼ï¼‰
"zh_male_yangguangqingnian_moon_bigtts"  # ç”·å£°ï¼ˆé˜³å…‰é’å¹´é£æ ¼ï¼‰
"ICL_zh_female_heainainai_tob"           # å¥³å£°ï¼ˆå¯çˆ±é£æ ¼ï¼‰
```

## æ³¨æ„äº‹é¡¹

### ä½¿ç”¨é™åˆ¶
- **æ–‡æ¡£æ ¼å¼**ï¼šæ”¯æŒEPUBå’ŒPDFæ ¼å¼ï¼ˆPDFå»ºè®®ä¸ºæ–‡æœ¬æ ¼å¼ï¼Œéæ‰«æä»¶ï¼‰
- **æ–‡æ¡£å¤§å°**ï¼šå¯å¤„ç†10ä¸‡å­—çº§åˆ«çš„é•¿ç¯‡æ–‡æ¡£
- **ç›®æ ‡å­—æ•°**ï¼š500-1000å­—ï¼ˆç³»ç»Ÿä¼šè‡ªåŠ¨éªŒè¯ï¼‰
- **åˆ†æ®µæ•°é‡**ï¼š5-20æ®µ
- **å›¾åƒç”Ÿæˆ**ï¼šå—å†…å®¹æ”¿ç­–é™åˆ¶ï¼Œé¿å…æ•æ„Ÿå†…å®¹

### ç³»ç»Ÿéœ€æ±‚
- **APIå¯†é’¥**ï¼šç¡®ä¿é…ç½®äº†æ‰€éœ€çš„APIå¯†é’¥
- **ç½‘ç»œè¿æ¥**ï¼šéœ€è¦ç¨³å®šçš„äº’è”ç½‘è¿æ¥è®¿é—®AIæœåŠ¡
- **å­˜å‚¨ç©ºé—´**ï¼šæ¯ä¸ªè§†é¢‘é¡¹ç›®çº¦éœ€è¦50-200MBç©ºé—´
- **å¤„ç†æ—¶é—´**ï¼šæ ¹æ®æ–‡æ¡£é•¿åº¦å’Œåˆ†æ®µæ•°ï¼Œå¤„ç†æ—¶é—´çº¦2-10åˆ†é’Ÿ

### é”™è¯¯å¤„ç†
- ç¨‹åºå…·å¤‡å®Œæ•´çš„é”™è¯¯å¤„ç†æœºåˆ¶
- æ”¯æŒAPIè°ƒç”¨å¤±è´¥é‡è¯•
- è¯¦ç»†çš„æ—¥å¿—è®°å½•ï¼Œä¾¿äºé—®é¢˜æ’æŸ¥
- å»ºè®®è¿è¡Œå‰ä½¿ç”¨ `check_config.py` éªŒè¯é…ç½®

## é¡¹ç›®ç»“æ„

```
AIGC_Video/
â”œâ”€â”€ main.py              # ä¸»ç¨‹åºå…¥å£
â”œâ”€â”€ functions.py         # æ ¸å¿ƒåŠŸèƒ½æ¨¡å—
â”œâ”€â”€ config.py           # é…ç½®ç®¡ç†
â”œâ”€â”€ genai_api.py        # AIæœåŠ¡APIæ¥å£
â”œâ”€â”€ utils.py            # å·¥å…·å‡½æ•°
â”œâ”€â”€ prompts.py          # AIæç¤ºè¯æ¨¡æ¿
â”œâ”€â”€ check_config.py     # é…ç½®æ£€æŸ¥å·¥å…·
â”œâ”€â”€ requirements.txt    # ä¾èµ–åŒ…åˆ—è¡¨
â”œâ”€â”€ README.md          # é¡¹ç›®è¯´æ˜æ–‡æ¡£
â”œâ”€â”€ .env               # ç¯å¢ƒå˜é‡é…ç½®ï¼ˆéœ€è¦è‡ªå·±åˆ›å»ºï¼‰
â”œâ”€â”€ input/             # è¾“å…¥æ–‡ä»¶ç›®å½•
â””â”€â”€ output/            # è¾“å‡ºæ–‡ä»¶ç›®å½•
    â””â”€â”€ {é¡¹ç›®å}_{æ—¶é—´}/
        â”œâ”€â”€ images/     # ç”Ÿæˆçš„å›¾ç‰‡
        â”œâ”€â”€ voice/      # ç”Ÿæˆçš„è¯­éŸ³
        â”œâ”€â”€ text/       # è„šæœ¬å’Œå…³é”®è¯
        â””â”€â”€ final_video.mp4  # æœ€ç»ˆè§†é¢‘
```
